<!-- Game frame overlay -->
<div id="gameOverlay">
  <iframe id="gameFrame" src="" frameborder="0"></iframe>
  <div id="gameControls">
    <button onclick="exitGame()">Exit</button>
    <button onclick="toggleFullscreen()">Fullscreen</button>
    <button id="panicButton" onclick="panic()" style="display:none;">PANIC</button>
  </div>
</div>

<style>
  #gameOverlay {
    position: fixed;
    top: 10%;
    left: 10%;
    width: 80%;
    height: 80%;
    background: #111;
    border: 4px solid #fff;
    display: none;
    flex-direction: column;
    z-index: 10000;
  }

  #gameFrame {
    flex: 1;
    width: 100%;
    border: none;
    border-radius: 5px 5px 0 0;
  }

  #gameControls {
    background: #222;
    padding: 0.5rem;
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
  }

  #gameControls button {
    padding: 0.5rem 1rem;
    font-size: 1rem;
    border-radius: 5px;
    border: none;
    cursor: pointer;
  }
</style>

<script>
  function launchGame(dir) {
    const overlay = document.getElementById('gameOverlay');
    const frame = document.getElementById('gameFrame');
    frame.src = dir + 'game.html'; // load game in iframe
    overlay.style.display = 'flex';
    updatePanicButton();
  }

  function exitGame() {
    const overlay = document.getElementById('gameOverlay');
    const frame = document.getElementById('gameFrame');
    frame.src = '';
    overlay.style.display = 'none';
  }

  function toggleFullscreen() {
    const overlay = document.getElementById('gameOverlay');
    if (!document.fullscreenElement) {
      overlay.requestFullscreen().then(() => {
        document.getElementById('panicButton').style.display = 'none';
      });
    } else {
      document.exitFullscreen();
      updatePanicButton();
    }
  }

  function panic() {
    window.open('about:blank', '_blank'); // immediately opens a new tab
  }

  function updatePanicButton() {
    const btn = document.getElementById('panicButton');
    btn.style.display = document.fullscreenElement ? 'none' : 'block';
  }

  document.addEventListener('fullscreenchange', updatePanicButton);
</script>
